{"ast":null,"code":"var _jsxFileName = \"/media/giada/OS/Users/Asus/OneDrive - Universit\\xE0 degli Studi di Catania/_Universit\\xE0/Web Programming/Web_Programming/progetto/client/src/content/EventDetails.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport Navbar from './Navbar';\nimport Footer from './Footer';\nimport CarouselComponent from './CarouselComponent';\nimport \"slick-carousel/slick/slick.css\";\nimport \"slick-carousel/slick/slick-theme.css\";\nimport getSocket from './Socket';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst EventDetails = () => {\n  _s();\n  const token = sessionStorage.getItem('token');\n  const [event, setEvent] = useState(null);\n  const [user, setUser] = useState(null);\n  const [organizer, setOrganizer] = useState(false);\n  const [totalParticipants, setTotalParticipants] = useState('');\n  const [isParticipating, setIsParticipating] = useState(false);\n  const [comments, setComments] = useState([]);\n  const [error, setError] = useState('');\n  const [formData, setFormData] = useState({\n    text: ''\n  });\n  const location = useLocation();\n  const navigate = useNavigate();\n  const socket = getSocket();\n  useEffect(() => {\n    const queryParams = new URLSearchParams(location.search);\n    const eventId = queryParams.get('id');\n    if (eventId) {\n      axios.get(`/api/events/${eventId}`, {\n        headers: {\n          authorization: token\n        }\n      }).then(response => {\n        setEvent(response.data);\n        fetchEventComments(eventId);\n      }).catch(error => {\n        setError('Failed to load event details');\n        console.error(error);\n      });\n      axios.get('/api/auth/verify', {\n        headers: {\n          authorization: token\n        }\n      }).then(response => {\n        if (response.status !== 200) {\n          navigate('/homepage');\n        } else {\n          setUser(response.data.user);\n          fetchParticipationStatus(response.data.user._id);\n          fetchParticipantNumber();\n        }\n      }).catch(error => {\n        console.error('Verification error:', error);\n        navigate('/homepage');\n      });\n      axios.get('/api/auth/verifyOrganizer', {\n        headers: {\n          authorization: token\n        }\n      }).then(response => {\n        setOrganizer(response.status === 200);\n      }).catch(error => {\n        console.error('Verification error:', error);\n        setOrganizer(false);\n      });\n    } else {\n      setError('Event ID not found');\n    }\n    socket.on('newComment', savedComment => {\n      setComments(prevComments => {\n        const updatedComments = [...prevComments, savedComment];\n        updatedComments.sort((a, b) => new Date(b.date) - new Date(a.date));\n        return updatedComments;\n      });\n    });\n    return () => {\n      socket.off('newComment');\n    };\n  }, [location, token, navigate]);\n  const fetchParticipationStatus = async userId => {\n    const queryParams = new URLSearchParams(location.search);\n    const eventId = queryParams.get('id');\n    try {\n      const response = await axios.get('/api/participate/check', {\n        params: {\n          eventId,\n          userId\n        }\n      });\n      setIsParticipating(response.data.participates);\n    } catch (error) {\n      console.error('Error fetching participation status:', error);\n    }\n  };\n  const fetchEventComments = async eventId => {\n    try {\n      const response = await axios.get('/api/events/commentsOf', {\n        headers: {\n          event: eventId\n        }\n      });\n      const comments = response.data.comments || [];\n      comments.sort((a, b) => new Date(b.date) - new Date(a.date));\n      setComments(comments);\n    } catch (error) {\n      setError('Failed to load comments');\n      console.error(error);\n    }\n  };\n  const fetchParticipantNumber = async () => {\n    const queryParams = new URLSearchParams(location.search);\n    const eventId = queryParams.get('id');\n    try {\n      const response = await axios.get('/api/participate/count', {\n        params: {\n          eventId\n        }\n      });\n      setTotalParticipants(response.data.total);\n    } catch (error) {\n      console.error('Error fetching participant number:', error);\n    }\n  };\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setFormData(prevData => ({\n      ...prevData,\n      [name]: value\n    }));\n  };\n  const handleParticipate = async e => {\n    e.preventDefault();\n    const queryParams = new URLSearchParams(location.search);\n    const eventId = queryParams.get('id');\n    try {\n      const response = await axios.post('/api/participate', {\n        dati: {\n          eventId,\n          userId: user._id\n        }\n      }, {\n        headers: {\n          authorization: token\n        }\n      });\n      if (response.status === 200) {\n        fetchParticipationStatus(user._id);\n        fetchParticipantNumber();\n      } else {\n        console.error('Error during participation:', response);\n        alert('Unable to confirm participation.');\n      }\n    } catch (error) {\n      console.error('Error:', error);\n      alert('Error in participation request.');\n    }\n  };\n  const handleNotParticipate = async e => {\n    e.preventDefault();\n    const queryParams = new URLSearchParams(location.search);\n    const eventId = queryParams.get('id');\n    try {\n      const response = await axios.post('/api/participate/stop', {\n        dati: {\n          eventId,\n          userId: user._id\n        }\n      });\n      if (response.status === 200) {\n        fetchParticipationStatus(user._id);\n        fetchParticipantNumber();\n      } else {\n        console.error('Error during non-participation:', response);\n        alert('Unable to confirm non-participation.');\n      }\n    } catch (error) {\n      console.error('Error:', error);\n      alert('Error in non-participation request.');\n    }\n  };\n  const handleDeleteEvent = async e => {\n    e.preventDefault();\n    const queryParams = new URLSearchParams(location.search);\n    const eventId = queryParams.get('id');\n    try {\n      const response = await axios.delete('/api/events/delete', {\n        headers: {\n          authorization: token\n        },\n        params: {\n          eventId\n        }\n      });\n      if (response.status === 200) {\n        alert('Event deleted');\n        navigate('/organizer');\n      } else {\n        console.error('Error during deletion:', response);\n        alert('Unable to confirm deletion.');\n      }\n    } catch (error) {\n      console.error('Error:', error);\n      alert('Error in deletion request.');\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const queryParams = new URLSearchParams(location.search);\n    const comment = {\n      text: formData.text,\n      user: user._id,\n      event: queryParams.get('id'),\n      date: new Date()\n    };\n    try {\n      const response = await axios.post('/api/events/addComment', comment);\n      if (response.status === 201) {\n        socket.emit('sendComment', response.data);\n        setFormData({\n          text: ''\n        });\n      } else {\n        console.error('Error adding comment:', response);\n      }\n    } catch (error) {\n      console.error('Error:', error);\n    }\n  };\n  const handleProfile = userId => {\n    navigate(`/user?id=${userId}`);\n  };\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mt-5\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-center text-danger\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 13\n    }, this);\n  }\n  if (!event) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mt-5\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-center text-muted\",\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 13\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"d-flex flex-column min-vh-100 bg-light\",\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container mt-4 mb-5 px-lg-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card shadow-sm rounded-lg border-0\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex justify-content-between align-items-center mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"a\", {\n              className: \"text-decoration-none\",\n              href: \"javascript:history.back()\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"btn btn-light\",\n                children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  width: \"35\",\n                  height: \"35\",\n                  fill: \"currentColor\",\n                  className: \"bi text-dark bi-arrow-return-left\",\n                  viewBox: \"0 0 16 16\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    fillRule: \"evenodd\",\n                    d: \"M14.5 1.5a.5.5 0 0 1 .5.5v4.8a2.5 2.5 0 0 1-2.5 2.5H2.707l3.347 3.346a.5.5 0 0 1-.708.708l-4.2-4.2a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 8.3H12.5A1.5 1.5 0 0 0 14 6.8V2a.5.5 0 0 1 .5-.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 247,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 246,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-center\",\n              children: event.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: `btn ${isParticipating ? 'btn-danger' : 'btn-outline-danger'}`,\n              onClick: isParticipating ? handleNotParticipate : handleParticipate,\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                width: \"20\",\n                height: \"20\",\n                fill: \"currentColor\",\n                className: `bi bi-heart me-2 ${isParticipating ? 'text-danger' : ''}`,\n                viewBox: \"0 0 16 16\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 258,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"d-inline\",\n                children: isParticipating ? 'Partecipo' : 'Partecipa'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-lg-6 mb-4\",\n              children: /*#__PURE__*/_jsxDEV(CarouselComponent, {\n                images: event.images\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-lg-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-start text-muted\",\n                children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Numero di partecipanti:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 270,\n                    columnNumber: 41\n                  }, this), \" \", totalParticipants]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n                  className: \"text-capitalize\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Categoria:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 271,\n                    columnNumber: 69\n                  }, this), \" \", event.category]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 271,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Data:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 272,\n                    columnNumber: 41\n                  }, this), \" \", new Date(event.date).toLocaleDateString('it-IT', {\n                    year: 'numeric',\n                    month: 'numeric',\n                    day: 'numeric'\n                  }), \" \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \" \\u2002Ora:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 272,\n                    columnNumber: 170\n                  }, this), \" \", new Date(event.date).toLocaleTimeString('it-IT', {\n                    hour: '2-digit',\n                    minute: '2-digit'\n                  })]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 272,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Luogo:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 273,\n                    columnNumber: 41\n                  }, this), \" \", event.location]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 273,\n                  columnNumber: 37\n                }, this), event.description && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-muted\",\n                  children: event.description\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 274,\n                  columnNumber: 59\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                onSubmit: handleSubmit,\n                className: \"mt-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-floating mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                    className: \"form-control border-primary\",\n                    name: \"text\",\n                    id: \"text\",\n                    placeholder: \"Commento...\",\n                    rows: \"3\",\n                    value: formData.text,\n                    onChange: handleChange,\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 279,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"text\",\n                    className: \"form-label text-muted\",\n                    children: \"Commento...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 289,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 278,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-flex justify-content-end\",\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"submit\",\n                    className: \"btn btn-danger\",\n                    children: \"Invia\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 292,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 291,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 25\n          }, this), organizer && event.organizer === user._id && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-danger text-white col-12 mt-3\",\n            onClick: handleDeleteEvent,\n            children: \"Elimina Evento\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n            className: \"mt-5\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"text-danger fw-bold\",\n              children: \"Commenti\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"container mt-3\",\n              children: comments.length > 0 ? comments.map((comment, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"card my-3 p-3 shadow-sm border-light rounded\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-flex justify-content-between align-items-center mb-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn btn-link text-danger fw-bold\",\n                    onClick: () => handleProfile(comment.user._id),\n                    children: comment.user.username || 'Anonimo'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 309,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-muted\",\n                    children: new Date(comment.date).toLocaleDateString('it-IT', {\n                      year: 'numeric',\n                      month: 'numeric',\n                      day: 'numeric'\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 315,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"mb-0\",\n                  children: comment.text\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 319,\n                  columnNumber: 45\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 307,\n                columnNumber: 41\n              }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-center text-muted\",\n                children: /*#__PURE__*/_jsxDEV(\"h6\", {\n                  children: \"Ancora nessun commento\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 324,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 323,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 237,\n    columnNumber: 9\n  }, this);\n};\n_s(EventDetails, \"7d3ml59d0a79izNRsIy8zlSHO8U=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = EventDetails;\nexport default EventDetails;\nvar _c;\n$RefreshReg$(_c, \"EventDetails\");","map":{"version":3,"names":["React","useEffect","useState","axios","useNavigate","useLocation","Navbar","Footer","CarouselComponent","getSocket","jsxDEV","_jsxDEV","EventDetails","_s","token","sessionStorage","getItem","event","setEvent","user","setUser","organizer","setOrganizer","totalParticipants","setTotalParticipants","isParticipating","setIsParticipating","comments","setComments","error","setError","formData","setFormData","text","location","navigate","socket","queryParams","URLSearchParams","search","eventId","get","headers","authorization","then","response","data","fetchEventComments","catch","console","status","fetchParticipationStatus","_id","fetchParticipantNumber","on","savedComment","prevComments","updatedComments","sort","a","b","Date","date","off","userId","params","participates","total","handleChange","e","name","value","target","prevData","handleParticipate","preventDefault","post","dati","alert","handleNotParticipate","handleDeleteEvent","delete","handleSubmit","comment","emit","handleProfile","className","children","fileName","_jsxFileName","lineNumber","columnNumber","href","type","xmlns","width","height","fill","viewBox","fillRule","d","title","onClick","images","category","toLocaleDateString","year","month","day","toLocaleTimeString","hour","minute","description","onSubmit","id","placeholder","rows","onChange","required","htmlFor","length","map","index","username","_c","$RefreshReg$"],"sources":["/media/giada/OS/Users/Asus/OneDrive - Università degli Studi di Catania/_Università/Web Programming/Web_Programming/progetto/client/src/content/EventDetails.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport Navbar from './Navbar';\nimport Footer from './Footer';\nimport CarouselComponent from './CarouselComponent';\nimport \"slick-carousel/slick/slick.css\";\nimport \"slick-carousel/slick/slick-theme.css\";\nimport getSocket from './Socket';\n\nconst EventDetails = () => {\n    const token = sessionStorage.getItem('token');\n    const [event, setEvent] = useState(null);\n    const [user, setUser] = useState(null);\n    const [organizer, setOrganizer] = useState(false);\n    const [totalParticipants, setTotalParticipants] = useState('');\n    const [isParticipating, setIsParticipating] = useState(false);\n    const [comments, setComments] = useState([]);\n    const [error, setError] = useState('');\n    const [formData, setFormData] = useState({ text: '' });\n    const location = useLocation();\n    const navigate = useNavigate();\n    const socket = getSocket();\n\n    useEffect(() => {\n        const queryParams = new URLSearchParams(location.search);\n        const eventId = queryParams.get('id');\n\n        if (eventId) {\n            axios.get(`/api/events/${eventId}`, { headers: { authorization: token } })\n                .then(response => {\n                    setEvent(response.data);\n                    fetchEventComments(eventId);\n                })\n                .catch(error => {\n                    setError('Failed to load event details');\n                    console.error(error);\n                });\n\n            axios.get('/api/auth/verify', { headers: { authorization: token } })\n                .then(response => {\n                    if (response.status !== 200) {\n                        navigate('/homepage');\n                    } else {\n                        setUser(response.data.user);\n                        fetchParticipationStatus(response.data.user._id);\n                        fetchParticipantNumber();\n                    }\n                })\n                .catch(error => {\n                    console.error('Verification error:', error);\n                    navigate('/homepage');\n                });\n\n            axios.get('/api/auth/verifyOrganizer', { headers: { authorization: token } })\n                .then(response => {\n                    setOrganizer(response.status === 200);\n                })\n                .catch(error => {\n                    console.error('Verification error:', error);\n                    setOrganizer(false);\n                });\n        } else {\n            setError('Event ID not found');\n        }\n\n        socket.on('newComment', (savedComment) => {\n            setComments(prevComments => {\n                const updatedComments = [...prevComments, savedComment];\n                updatedComments.sort((a, b) => new Date(b.date) - new Date(a.date));\n                return updatedComments;\n            });\n        });\n\n        return () => {\n            socket.off('newComment');\n        };\n    }, [location, token, navigate]);\n\n    const fetchParticipationStatus = async (userId) => {\n        const queryParams = new URLSearchParams(location.search);\n        const eventId = queryParams.get('id');\n\n        try {\n            const response = await axios.get('/api/participate/check', {\n                params: { eventId, userId }\n            });\n            setIsParticipating(response.data.participates);\n        } catch (error) {\n            console.error('Error fetching participation status:', error);\n        }\n    };\n\n    const fetchEventComments = async (eventId) => {\n        try {\n            const response = await axios.get('/api/events/commentsOf', { headers: { event: eventId } });\n            const comments = response.data.comments || [];\n            comments.sort((a, b) => new Date(b.date) - new Date(a.date));\n            setComments(comments);\n        } catch (error) {\n            setError('Failed to load comments');\n            console.error(error);\n        }\n    };\n\n    const fetchParticipantNumber = async () => {\n        const queryParams = new URLSearchParams(location.search);\n        const eventId = queryParams.get('id');\n\n        try {\n            const response = await axios.get('/api/participate/count', { params: { eventId } });\n            setTotalParticipants(response.data.total);\n        } catch (error) {\n            console.error('Error fetching participant number:', error);\n        }\n    };\n\n    const handleChange = (e) => {\n        const { name, value } = e.target;\n        setFormData(prevData => ({ ...prevData, [name]: value }));\n    };\n\n    const handleParticipate = async (e) => {\n        e.preventDefault();\n        const queryParams = new URLSearchParams(location.search);\n        const eventId = queryParams.get('id');\n\n        try {\n            const response = await axios.post('/api/participate', {\n                dati: { eventId, userId: user._id }\n            }, { headers: { authorization: token } });\n\n            if (response.status === 200) {\n                fetchParticipationStatus(user._id);\n                fetchParticipantNumber();\n            } else {\n                console.error('Error during participation:', response);\n                alert('Unable to confirm participation.');\n            }\n        } catch (error) {\n            console.error('Error:', error);\n            alert('Error in participation request.');\n        }\n    };\n\n    const handleNotParticipate = async (e) => {\n        e.preventDefault();\n        const queryParams = new URLSearchParams(location.search);\n        const eventId = queryParams.get('id');\n\n        try {\n            const response = await axios.post('/api/participate/stop', {\n                dati: { eventId, userId: user._id }\n            });\n\n            if (response.status === 200) {\n                fetchParticipationStatus(user._id);\n                fetchParticipantNumber();\n            } else {\n                console.error('Error during non-participation:', response);\n                alert('Unable to confirm non-participation.');\n            }\n        } catch (error) {\n            console.error('Error:', error);\n            alert('Error in non-participation request.');\n        }\n    };\n\n    const handleDeleteEvent = async (e) => {\n        e.preventDefault();\n        const queryParams = new URLSearchParams(location.search);\n        const eventId = queryParams.get('id');\n\n        try {\n            const response = await axios.delete('/api/events/delete', {\n                headers: { authorization: token },\n                params: { eventId }\n            });\n\n            if (response.status === 200) {\n                alert('Event deleted');\n                navigate('/organizer');\n            } else {\n                console.error('Error during deletion:', response);\n                alert('Unable to confirm deletion.');\n            }\n        } catch (error) {\n            console.error('Error:', error);\n            alert('Error in deletion request.');\n        }\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        const queryParams = new URLSearchParams(location.search);\n        const comment = {\n            text: formData.text,\n            user: user._id,\n            event: queryParams.get('id'),\n            date: new Date()\n        };\n\n        try {\n            const response = await axios.post('/api/events/addComment', comment);\n            if (response.status === 201) {\n                socket.emit('sendComment', response.data);\n                setFormData({ text: '' });\n            } else {\n                console.error('Error adding comment:', response);\n            }\n        } catch (error) {\n            console.error('Error:', error);\n        }\n    };\n\n    const handleProfile = (userId) => {\n        navigate(`/user?id=${userId}`);\n    };\n\n    if (error) {\n        return (\n            <div className=\"container mt-5\">\n                <p className=\"text-center text-danger\">{error}</p>\n            </div>\n        );\n    }\n\n    if (!event) {\n        return (\n            <div className=\"container mt-5\">\n                <p className=\"text-center text-muted\">Loading...</p>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"d-flex flex-column min-vh-100 bg-light\">\n            <Navbar />\n\n            <div className=\"container mt-4 mb-5 px-lg-5\">\n                <div className=\"card shadow-sm rounded-lg border-0\">\n                    <div className=\"card-body\">\n                        <div className=\"d-flex justify-content-between align-items-center mb-4\">\n                            <a className='text-decoration-none' href=\"javascript:history.back()\">\n                                <button type=\"button\" className=\"btn btn-light\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"35\" height=\"35\" fill=\"currentColor\" className=\"bi text-dark bi-arrow-return-left\" viewBox=\"0 0 16 16\">\n                                        <path fillRule=\"evenodd\" d=\"M14.5 1.5a.5.5 0 0 1 .5.5v4.8a2.5 2.5 0 0 1-2.5 2.5H2.707l3.347 3.346a.5.5 0 0 1-.708.708l-4.2-4.2a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 8.3H12.5A1.5 1.5 0 0 0 14 6.8V2a.5.5 0 0 1 .5-.5\" />\n                                    </svg>\n                                </button>\n                            </a>\n                            <h2 className=\"text-center\">{event.title}</h2>\n                            <button \n                                type=\"button\" \n                                className={`btn ${isParticipating ? 'btn-danger' : 'btn-outline-danger'}`}\n                                onClick={isParticipating ? handleNotParticipate : handleParticipate}\n                            >\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" fill=\"currentColor\" className={`bi bi-heart me-2 ${isParticipating ? 'text-danger' : ''}`} viewBox=\"0 0 16 16\">\n                                    <path d=\"m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15\" />\n                                </svg>\n                                <span className=\"d-inline\">{isParticipating ? 'Partecipo' : 'Partecipa'}</span>\n                            </button>\n                        </div>\n\n                        <div className=\"row\">\n                            <div className=\"col-lg-6 mb-4\">\n                                <CarouselComponent images={event.images} />\n                            </div>\n                            <div className=\"col-lg-6\">\n                                <div className=\"text-start text-muted\">\n                                    <h5><strong>Numero di partecipanti:</strong> {totalParticipants}</h5>\n                                    <h5 className='text-capitalize'><strong>Categoria:</strong> {event.category}</h5>\n                                    <h5><strong>Data:</strong> {new Date(event.date).toLocaleDateString('it-IT', { year: 'numeric', month: 'numeric', day: 'numeric' })} <strong> &ensp;Ora:</strong> {new Date(event.date).toLocaleTimeString('it-IT', { hour: '2-digit', minute: '2-digit' })}</h5>\n                                    <h5><strong>Luogo:</strong> {event.location}</h5>\n                                    {event.description && <p className='text-muted'>{event.description}</p>}\n                                </div>\n\n                                <form onSubmit={handleSubmit} className='mt-4'>\n                                    <div className=\"form-floating mb-3\">\n                                        <textarea\n                                            className=\"form-control border-primary\"\n                                            name=\"text\"\n                                            id=\"text\"\n                                            placeholder=\"Commento...\"\n                                            rows=\"3\"\n                                            value={formData.text}\n                                            onChange={handleChange}\n                                            required\n                                        ></textarea>\n                                        <label htmlFor=\"text\" className=\"form-label text-muted\">Commento...</label>\n                                    </div>\n                                    <div className=\"d-flex justify-content-end\">\n                                        <button type=\"submit\" className=\"btn btn-danger\">Invia</button>\n                                    </div>\n                                </form>\n                            </div>\n                        </div>\n\n                        {organizer && (event.organizer === user._id) && (\n                            <button className='btn btn-danger text-white col-12 mt-3' onClick={handleDeleteEvent}>Elimina Evento</button>\n                        )}\n\n                        <section className=\"mt-5\">\n                            <h4 className=\"text-danger fw-bold\">Commenti</h4>\n                            <div className=\"container mt-3\">\n                                {comments.length > 0 ? (\n                                    comments.map((comment, index) => (\n                                        <div key={index} className=\"card my-3 p-3 shadow-sm border-light rounded\">\n                                            <div className=\"d-flex justify-content-between align-items-center mb-2\">\n                                                <button \n                                                    className=\"btn btn-link text-danger fw-bold\" \n                                                    onClick={() => handleProfile(comment.user._id)}\n                                                >\n                                                    {comment.user.username || 'Anonimo'}\n                                                </button>\n                                                <span className=\"text-muted\">\n                                                    {new Date(comment.date).toLocaleDateString('it-IT', { year: 'numeric', month: 'numeric', day: 'numeric' })}\n                                                </span>\n                                            </div>\n                                            <p className=\"mb-0\">{comment.text}</p>\n                                        </div>\n                                    ))\n                                ) : (\n                                    <div className=\"text-center text-muted\">\n                                        <h6>Ancora nessun commento</h6>\n                                    </div>\n                                )}\n                            </div>\n                        </section>\n                    </div>\n                </div>\n            </div>\n\n            <Footer />\n        </div>\n    );\n}\n\nexport default EventDetails;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}